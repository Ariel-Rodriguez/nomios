{"version":3,"sources":["lib/delaunay.js","lib/three/ShaderPass.js","lib/three/index.js","lib/three/MaskPass.js","lib/three/EdgeShader.js","lib/three/RenderPass.js","lib/three/CopyShader.js","lib/three/EffectComposer.js","lib/GlRenderer.js","BtnRecord/BtnRecord.js","ToggleSwitch/ToggleSwitch.js","MenuOptions/index.js","Video/Recorder.js","lib/download.js","Video/Video.js","App.js","serviceWorker.js","index.js"],"names":["EPSILON","circumcircle","vertices","i","j","k","xc","yc","m1","m2","mx1","mx2","my1","my2","dx","dy","x1","y1","x2","y2","x3","y3","fabsy1y2","Math","abs","fabsy2y3","x","y","r","dedup","edges","a","b","m","n","length","splice","Delaunay","THREE","require","MaskPass","scene","camera","this","enabled","clear","needsSwap","inverse","prototype","render","renderer","writeBuffer","readBuffer","delta","writeValue","clearValue","context","colorMask","depthMask","enable","STENCIL_TEST","stencilOp","REPLACE","stencilFunc","ALWAYS","clearStencil","EQUAL","KEEP","ClearMaskPass","disable","MaskTools","EdgeShader","uniforms","tDiffuse","type","value","aspect","Vector2","vertexShader","join","fragmentShader","RenderPass","overrideMaterial","clearColor","clearAlpha","undefined","oldClearColor","Color","oldClearAlpha","copy","getClearColor","getClearAlpha","setClearColor","ShaderPass","shader","textureID","UniformsUtils","clone","material","ShaderMaterial","defines","renderToScreen","OrthographicCamera","Scene","quad","Mesh","PlaneBufferGeometry","add","CopyShader","opacity","EffectComposer","renderTarget","pixelRatio","getPixelRatio","width","floor","canvas","height","parameters","minFilter","LinearFilter","magFilter","format","RGBFormat","stencilBuffer","WebGLRenderTarget","renderTarget1","renderTarget2","passes","console","error","copyPass","swapBuffers","tmp","addPass","pass","push","insertPass","index","maskActive","il","NOTEQUAL","reset","setSize","GPU","GlRenderer","maxVertexCnt","isImg","imgPath","videoElement","callback","video","videoWidth","videoHeight","init","updateImage","hasWireframe","WebGLRenderer","antialias","preserveDrawingBuffer","finalScene","position","set","renderPass","edgeShader","effectCopy","composer","wireframeMaterial","MeshBasicMaterial","wireframe","color","wireframeMesh","faceMaterial","vertexColors","FaceColors","faceMesh","videoImage","document","createElement","videoSrcImage","videoSrcCtx","getContext","videoImageContext","fillStyle","fillRect","videoTexture","Texture","videoMaterial","map","overdraw","videoGeometry","videoMesh","lastSelected","thisSelected","setVertexCnt","cnt","setTriangleRendering","renderTrianglesEnabled","_isLastSelected","ys","_setThisSelected","setWireframe","visible","_renderSize","imgMesh","remove","preRender","size","getRenderSize","that","srcTexture","ImageUtils","loadTexture","process","w","h","z","drawImage","needsUpdate","iw","ih","gl","pixels","Uint8Array","readPixels","ow","oh","RGBA","UNSIGNED_BYTE","len","loops","xi","parseInt","yi","id","random","edgeCnt","maxLoop","red","rx","ry","triangles","Delaunator","from","renderTriangles","iwn","ihn","srcImg","geo","Geometry","fid","dw","dh","c","min","max","rgb","srcPixel","Vector3","faces","Face3","resize","updateProjectionMatrix","Image","src","img","onload","srcCtx","getImageData","data","imgWidth","imgHeight","cw","ch","BtnRecord","_ref","onClick","showHH","react_default","className","onChange","htmlFor","concat","ToggleSwitch","Options","React","Component","Recorder","options","arguments","Object","classCallCheck","isCCapturer","ccapturer","frames","worker","Worker","onmessage","e","msg","log","blob","Blob","MEMFS","navigator","share","title","text","url","strFileName","strMimeType","fr","self","window","u","D","String","B","MozBlob","WebKitBlob","BB","MSBlobBuilder","WebKitBlobBuilder","BlobBuilder","fn","match","msSaveBlob","p","split","t","bin","atob","decodeURIComponent","pop","mx","uia","charCodeAt","d2b","saver","append","getBlob","winMode","href","setAttribute","innerHTML","body","appendChild","setTimeout","click","removeChild","URL","revokeObjectURL","f","replace","createObjectURL","constructor","btoa","encodeURIComponent","FileReader","result","readAsDataURL","download","capture","binaryFrame","dataURI","base64","substring","raw","rawLength","array","ArrayBuffer","convertDataURIToBinary","toDataURL","name","fps","CCapture","framerate","start","stop","save","postMessage","TOTAL_MEMORY","Video","_this","possibleConstructorReturn","getPrototypeOf","call","state","isReady","isRecording","isCapturerReady","devices","fpsmeter","createRef","handlePlayState","bind","assertThisInitialized","renderFrame","handleRecord","prepare","logFPS","framesRendered","framesLow","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","alert","current","innerWidth","innerHeight","prevProps","prevState","isPlaying","play","setInterval","clearInterval","setState","capturer","mediaDevices","enumerateDevices","then","forEach","device","kind","_this2","deviceId","exact","stream","srcObject","onloadedmetadata","load","err","catch","_this3","_this$state","ref","MenuOptions_Options","disabled","target","checked","addFrame","requestAnimationFrame","App","Video_Video","publicUrl","props","Boolean","location","hostname","ReactDOM","src_App","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5901c274.chunk.js","sourcesContent":["// https://github.com/ironwallaby/delaunay\n\nvar Delaunay;\n\n  var EPSILON = 1.0 / 1048576.0;\n\n  function supertriangle(vertices) {\n    var xmin = Number.POSITIVE_INFINITY,\n        ymin = Number.POSITIVE_INFINITY,\n        xmax = Number.NEGATIVE_INFINITY,\n        ymax = Number.NEGATIVE_INFINITY,\n        i, dx, dy, dmax, xmid, ymid;\n\n    for(i = vertices.length; i--; ) {\n      if(vertices[i][0] < xmin) xmin = vertices[i][0];\n      if(vertices[i][0] > xmax) xmax = vertices[i][0];\n      if(vertices[i][1] < ymin) ymin = vertices[i][1];\n      if(vertices[i][1] > ymax) ymax = vertices[i][1];\n    }\n\n    dx = xmax - xmin;\n    dy = ymax - ymin;\n    dmax = Math.max(dx, dy);\n    xmid = xmin + dx * 0.5;\n    ymid = ymin + dy * 0.5;\n\n    return [\n      [xmid - 20 * dmax, ymid -      dmax],\n      [xmid            , ymid + 20 * dmax],\n      [xmid + 20 * dmax, ymid -      dmax]\n    ];\n  }\n\n  function circumcircle(vertices, i, j, k) {\n    var x1 = vertices[i][0],\n        y1 = vertices[i][1],\n        x2 = vertices[j][0],\n        y2 = vertices[j][1],\n        x3 = vertices[k][0],\n        y3 = vertices[k][1],\n        fabsy1y2 = Math.abs(y1 - y2),\n        fabsy2y3 = Math.abs(y2 - y3),\n        xc, yc, m1, m2, mx1, mx2, my1, my2, dx, dy;\n\n    /* Check for coincident points */\n    // if(fabsy1y2 < EPSILON && fabsy2y3 < EPSILON)\n    //   throw new Error(\"Eek! Coincident points!\");\n\n    if(fabsy1y2 < EPSILON) {\n      m2  = -((x3 - x2) / (y3 - y2));\n      mx2 = (x2 + x3) / 2.0;\n      my2 = (y2 + y3) / 2.0;\n      xc  = (x2 + x1) / 2.0;\n      yc  = m2 * (xc - mx2) + my2;\n    }\n\n    else if(fabsy2y3 < EPSILON) {\n      m1  = -((x2 - x1) / (y2 - y1));\n      mx1 = (x1 + x2) / 2.0;\n      my1 = (y1 + y2) / 2.0;\n      xc  = (x3 + x2) / 2.0;\n      yc  = m1 * (xc - mx1) + my1;\n    }\n\n    else {\n      m1  = -((x2 - x1) / (y2 - y1));\n      m2  = -((x3 - x2) / (y3 - y2));\n      mx1 = (x1 + x2) / 2.0;\n      mx2 = (x2 + x3) / 2.0;\n      my1 = (y1 + y2) / 2.0;\n      my2 = (y2 + y3) / 2.0;\n      xc  = (m1 * mx1 - m2 * mx2 + my2 - my1) / (m1 - m2);\n      yc  = (fabsy1y2 > fabsy2y3) ?\n        m1 * (xc - mx1) + my1 :\n        m2 * (xc - mx2) + my2;\n    }\n\n    dx = x2 - xc;\n    dy = y2 - yc;\n    return {i: i, j: j, k: k, x: xc, y: yc, r: dx * dx + dy * dy};\n  }\n\n  function dedup(edges) {\n    var i, j, a, b, m, n;\n\n    for(j = edges.length; j; ) {\n      b = edges[--j];\n      a = edges[--j];\n\n      for(i = j; i; ) {\n        n = edges[--i];\n        m = edges[--i];\n\n        if((a === m && b === n) || (a === n && b === m)) {\n          edges.splice(j, 2);\n          edges.splice(i, 2);\n          break;\n        }\n      }\n    }\n  }\n\n  Delaunay = {\n    triangulate: function(vertices, key) {\n      var n = vertices.length,\n          i, j, indices, st, open, closed, edges, dx, dy, a, b, c;\n\n      /* Bail if there aren't enough vertices to form any triangles. */\n      if(n < 3)\n        return [];\n\n      /* Slice out the actual vertices from the passed objects. (Duplicate the\n       * array even if we don't, though, since we need to make a supertriangle\n       * later on!) */\n      vertices = vertices.slice(0);\n\n      if(key)\n        for(i = n; i--; )\n          vertices[i] = vertices[i][key];\n\n      /* Make an array of indices into the vertex array, sorted by the\n       * vertices' x-position. */\n      indices = new Array(n);\n\n      for(i = n; i--; )\n        indices[i] = i;\n\n      indices.sort(function(i, j) {\n        return vertices[j][0] - vertices[i][0];\n      });\n\n      /* Next, find the vertices of the supertriangle (which contains all other\n       * triangles), and append them onto the end of a (copy of) the vertex\n       * array. */\n      st = supertriangle(vertices);\n      vertices.push(st[0], st[1], st[2]);\n      \n      /* Initialize the open list (containing the supertriangle and nothing\n       * else) and the closed list (which is empty since we havn't processed\n       * any triangles yet). */\n      open   = [circumcircle(vertices, n + 0, n + 1, n + 2)];\n      closed = [];\n      edges  = [];\n\n      /* Incrementally add each vertex to the mesh. */\n      for(i = indices.length; i--; edges.length = 0) {\n        c = indices[i];\n\n        /* For each open triangle, check to see if the current point is\n         * inside it's circumcircle. If it is, remove the triangle and add\n         * it's edges to an edge list. */\n        for(j = open.length; j--; ) {\n          /* If this point is to the right of this triangle's circumcircle,\n           * then this triangle should never get checked again. Remove it\n           * from the open list, add it to the closed list, and skip. */\n          dx = vertices[c][0] - open[j].x;\n          if(dx > 0.0 && dx * dx > open[j].r) {\n            closed.push(open[j]);\n            open.splice(j, 1);\n            continue;\n          }\n\n          /* If we're outside the circumcircle, skip this triangle. */\n          dy = vertices[c][1] - open[j].y;\n          if(dx * dx + dy * dy - open[j].r > EPSILON)\n            continue;\n\n          /* Remove the triangle and add it's edges to the edge list. */\n          edges.push(\n            open[j].i, open[j].j,\n            open[j].j, open[j].k,\n            open[j].k, open[j].i\n          );\n          open.splice(j, 1);\n        }\n\n        /* Remove any doubled edges. */\n        dedup(edges);\n\n        /* Add a new triangle for each edge. */\n        for(j = edges.length; j; ) {\n          b = edges[--j];\n          a = edges[--j];\n          open.push(circumcircle(vertices, a, b, c));\n        }\n      }\n\n      /* Copy any remaining open triangles to the closed list, and then\n       * remove any triangles that share a vertex with the supertriangle,\n       * building a list of triplets that represent triangles. */\n      for(i = open.length; i--; )\n        closed.push(open[i]);\n      open.length = 0;\n\n      for(i = closed.length; i--; )\n        if(closed[i].i < n && closed[i].j < n && closed[i].k < n)\n          open.push(closed[i].i, closed[i].j, closed[i].k);\n\n      /* Yay, we're done! */\n      return open;\n    },\n    contains: function(tri, p) {\n      /* Bounding box test first, for quick rejections. */\n      if((p[0] < tri[0][0] && p[0] < tri[1][0] && p[0] < tri[2][0]) ||\n         (p[0] > tri[0][0] && p[0] > tri[1][0] && p[0] > tri[2][0]) ||\n         (p[1] < tri[0][1] && p[1] < tri[1][1] && p[1] < tri[2][1]) ||\n         (p[1] > tri[0][1] && p[1] > tri[1][1] && p[1] > tri[2][1]))\n        return null;\n\n      var a = tri[1][0] - tri[0][0],\n          b = tri[2][0] - tri[0][0],\n          c = tri[1][1] - tri[0][1],\n          d = tri[2][1] - tri[0][1],\n          i = a * d - b * c;\n\n      /* Degenerate tri. */\n      if(i === 0.0)\n        return null;\n\n      var u = (d * (p[0] - tri[0][0]) - b * (p[1] - tri[0][1])) / i,\n          v = (a * (p[1] - tri[0][1]) - c * (p[0] - tri[0][0])) / i;\n\n      /* If we're outside the tri, fail. */\n      if(u < 0.0 || v < 0.0 || (u + v) > 1.0)\n        return null;\n\n      return [u, v];\n    }\n  };\n\nexport default Delaunay\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nexport default function (THREE) {\n  function ShaderPass( shader, textureID ) {\n\n    this.textureID = ( textureID !== undefined ) ? textureID : \"tDiffuse\";\n\n    this.uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n    this.material = new THREE.ShaderMaterial( {\n\n            defines: shader.defines || {},\n      uniforms: this.uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader\n\n    } );\n\n    this.renderToScreen = false;\n\n    this.enabled = true;\n    this.needsSwap = true;\n    this.clear = false;\n\n\n    this.camera = new THREE.OrthographicCamera( -1, 1, 1, -1, 0, 1 );\n    this.scene  = new THREE.Scene();\n\n    this.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n    this.scene.add( this.quad );\n\n  };\n\n  ShaderPass.prototype = {\n\n    render: function ( renderer, writeBuffer, readBuffer, delta ) {\n\n      if ( this.uniforms[ this.textureID ] ) {\n\n        this.uniforms[ this.textureID ].value = readBuffer;\n\n      }\n\n      this.quad.material = this.material;\n\n      if ( this.renderToScreen ) {\n\n        renderer.render( this.scene, this.camera );\n\n      } else {\n\n        renderer.render( this.scene, this.camera, writeBuffer, this.clear );\n\n      }\n\n    }\n  }\n  return ShaderPass\n}\n","import RenderPass from './RenderPass'\nimport EdgeShader from './EdgeShader'\nimport CopyShader from './CopyShader'\nimport ShaderPass from './ShaderPass'\nimport MaskTools from './MaskPass'\nimport EffectComposer from './EffectComposer'\n//import EffectASCII from './EffectASCII'\n\nconst THREE = require('three')\nconst { ClearMaskPass, MaskPass } = MaskTools(THREE)\nTHREE.ClearMaskPass = ClearMaskPass\nTHREE.MaskPass = MaskPass\nTHREE.EdgeShader = EdgeShader(THREE)\nTHREE.RenderPass = RenderPass(THREE)\nTHREE.ShaderPass = ShaderPass(THREE)\nTHREE.CopyShader = CopyShader(THREE)\nTHREE.EffectComposer = EffectComposer(THREE)\n// THREE.EffectASCII = EffectASCII(THREE)\n\nexport default THREE\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nexport default function(THREE) {\n  const MaskPass = function ( scene, camera ) {\n\n    this.scene = scene;\n    this.camera = camera;\n\n    this.enabled = true;\n    this.clear = true;\n    this.needsSwap = false;\n\n    this.inverse = false;\n\n  };\n\n  MaskPass.prototype = {\n\n    render: function ( renderer, writeBuffer, readBuffer, delta ) {\n\n      var context = renderer.context;\n\n      // don't update color or depth\n\n      context.colorMask( false, false, false, false );\n      context.depthMask( false );\n\n      // set up stencil\n\n      var writeValue, clearValue;\n\n      if ( this.inverse ) {\n\n        writeValue = 0;\n        clearValue = 1;\n\n      } else {\n\n        writeValue = 1;\n        clearValue = 0;\n\n      }\n\n      context.enable( context.STENCIL_TEST );\n      context.stencilOp( context.REPLACE, context.REPLACE, context.REPLACE );\n      context.stencilFunc( context.ALWAYS, writeValue, 0xffffffff );\n      context.clearStencil( clearValue );\n\n      // draw into the stencil buffer\n\n      renderer.render( this.scene, this.camera, readBuffer, this.clear );\n      renderer.render( this.scene, this.camera, writeBuffer, this.clear );\n\n      // re-enable update of color and depth\n\n      context.colorMask( true, true, true, true );\n      context.depthMask( true );\n\n      // only render where stencil is set to 1\n\n      context.stencilFunc( context.EQUAL, 1, 0xffffffff );  // draw if == 1\n      context.stencilOp( context.KEEP, context.KEEP, context.KEEP );\n\n    }\n\n  };\n\n\n  const ClearMaskPass = function () {\n\n    this.enabled = true;\n\n  };\n\n  ClearMaskPass.prototype = {\n\n    render: function ( renderer, writeBuffer, readBuffer, delta ) {\n\n      var context = renderer.context;\n\n      context.disable( context.STENCIL_TEST );\n\n    }\n\n  }\n\n  return { ClearMaskPass, MaskPass }\n}","export default function EdgeShader(THREE) {\n  return {\n\n    uniforms: {\n  \n      \"tDiffuse\": { type: \"t\", value: null },\n      \"aspect\":    { type: \"v2\", value: new THREE.Vector2(512, 512) },\n    },\n  \n    vertexShader: [\n  \n      \"varying vec2 vUv;\",\n  \n      \"void main() {\",\n  \n        \"vUv = uv;\",\n        \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n  \n      \"}\"\n  \n    ].join(\"\\n\"),\n  \n    fragmentShader: [\n  \n      \"uniform sampler2D tDiffuse;\",\n      \"varying vec2 vUv;\",\n      \"uniform vec2 aspect;\",\n  \n  \n      \"vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);\",\n  \n      \"mat3 G[2];\",\n  \n      \"const mat3 g0 = mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\",\n      \"const mat3 g1 = mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\",\n  \n  \n      \"void main(void)\",\n      \"{\",\n        \"mat3 I;\",\n        \"float cnv[2];\",\n        \"vec3 sample;\",\n  \n        \"G[0] = g0;\",\n        \"G[1] = g1;\",\n  \n        /* fetch the 3x3 neighbourhood and use the RGB vector's length as intensity value */\n        \"for (float i=0.0; i<3.0; i++)\",\n        \"for (float j=0.0; j<3.0; j++) {\",\n          \"sample = texture2D( tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;\",\n          \"I[int(i)][int(j)] = length(sample);\",\n        \"}\",\n  \n        /* calculate the convolution values for all the masks */\n        \"for (int i=0; i<2; i++) {\",\n          \"float dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\",\n          \"cnv[i] = dp3 * dp3; \",\n        \"}\",\n  \n        \"gl_FragColor = vec4(sqrt(cnv[0]*cnv[0]+cnv[1]*cnv[1]));\",\n      \"} \",\n  \n    ].join(\"\\n\")\n  \n  }\n}","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\n export default function RenderPass(THREE) {\n\n  function RenderPass( scene, camera, overrideMaterial, clearColor, clearAlpha ) {\n\n    this.scene = scene;\n    this.camera = camera;\n\n    this.overrideMaterial = overrideMaterial;\n\n    this.clearColor = clearColor;\n    this.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 1;\n\n    this.oldClearColor = new THREE.Color();\n    this.oldClearAlpha = 1;\n\n    this.enabled = true;\n    this.clear = true;\n    this.needsSwap = false;\n\n  };\n\n  RenderPass.prototype = {\n\n    render: function ( renderer, writeBuffer, readBuffer, delta ) {\n\n      this.scene.overrideMaterial = this.overrideMaterial;\n\n      if ( this.clearColor ) {\n\n        this.oldClearColor.copy( renderer.getClearColor() );\n        this.oldClearAlpha = renderer.getClearAlpha();\n\n        renderer.setClearColor( this.clearColor, this.clearAlpha );\n\n      }\n\n      renderer.render( this.scene, this.camera, readBuffer, this.clear );\n\n      if ( this.clearColor ) {\n\n        renderer.setClearColor( this.oldClearColor, this.oldClearAlpha );\n\n      }\n\n      this.scene.overrideMaterial = null;\n\n    }\n  }\n\n  return RenderPass\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n */\n\nexport default function CopyShader(THREE) {\n return {\n    uniforms: {\n\n      \"tDiffuse\": { type: \"t\", value: null },\n      \"opacity\":  { type: \"f\", value: 1.0 }\n\n    },\n\n    vertexShader: [\n\n      \"varying vec2 vUv;\",\n\n      \"void main() {\",\n\n        \"vUv = uv;\",\n        \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n      \"}\"\n\n    ].join(\"\\n\"),\n\n    fragmentShader: [\n\n      \"uniform float opacity;\",\n\n      \"uniform sampler2D tDiffuse;\",\n\n      \"varying vec2 vUv;\",\n\n      \"void main() {\",\n\n        \"vec4 texel = texture2D( tDiffuse, vUv );\",\n        \"gl_FragColor = opacity * texel;\",\n\n      \"}\"\n\n    ].join(\"\\n\")\n  }\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nexport default function (THREE) {\n  const EffectComposer = function ( renderer, renderTarget ) {\n\n    this.renderer = renderer;\n\n    if ( renderTarget === undefined ) {\n\n      var pixelRatio = renderer.getPixelRatio();\n\n      var width  = Math.floor( renderer.context.canvas.width  / pixelRatio ) || 1;\n      var height = Math.floor( renderer.context.canvas.height / pixelRatio ) || 1;\n      var parameters = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBFormat, stencilBuffer: false };\n\n      renderTarget = new THREE.WebGLRenderTarget( width, height, parameters );\n\n    }\n\n    this.renderTarget1 = renderTarget;\n    this.renderTarget2 = renderTarget.clone();\n\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n\n    this.passes = [];\n\n    if ( THREE.CopyShader === undefined )\n      console.error( \"THREE.EffectComposer relies on THREE.CopyShader\" );\n\n    this.copyPass = new THREE.ShaderPass( THREE.CopyShader );\n\n  };\n\n  EffectComposer.prototype = {\n\n    swapBuffers: function() {\n\n      var tmp = this.readBuffer;\n      this.readBuffer = this.writeBuffer;\n      this.writeBuffer = tmp;\n\n    },\n\n    addPass: function ( pass ) {\n\n      this.passes.push( pass );\n\n    },\n\n    insertPass: function ( pass, index ) {\n\n      this.passes.splice( index, 0, pass );\n\n    },\n\n    render: function ( delta ) {\n\n      this.writeBuffer = this.renderTarget1;\n      this.readBuffer = this.renderTarget2;\n\n      var maskActive = false;\n\n      var pass, i, il = this.passes.length;\n\n      for ( i = 0; i < il; i ++ ) {\n\n        pass = this.passes[ i ];\n\n        if ( !pass.enabled ) continue;\n\n        pass.render( this.renderer, this.writeBuffer, this.readBuffer, delta, maskActive );\n\n        if ( pass.needsSwap ) {\n\n          if ( maskActive ) {\n\n            var context = this.renderer.context;\n\n            context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n            this.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, delta );\n\n            context.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\n          }\n\n          this.swapBuffers();\n\n        }\n\n        if ( pass instanceof THREE.MaskPass ) {\n\n          maskActive = true;\n\n        } else if ( pass instanceof THREE.ClearMaskPass ) {\n\n          maskActive = false;\n\n        }\n\n      }\n\n    },\n\n    reset: function ( renderTarget ) {\n\n      if ( renderTarget === undefined ) {\n\n        renderTarget = this.renderTarget1.clone();\n\n        var pixelRatio = this.renderer.getPixelRatio();\n\n        renderTarget.width  = Math.floor( this.renderer.context.canvas.width  / pixelRatio );\n        renderTarget.height = Math.floor( this.renderer.context.canvas.height / pixelRatio );\n\n      }\n\n      this.renderTarget1 = renderTarget;\n      this.renderTarget2 = renderTarget.clone();\n\n      this.writeBuffer = this.renderTarget1;\n      this.readBuffer = this.renderTarget2;\n\n    },\n\n    setSize: function ( width, height ) {\n\n      var renderTarget = this.renderTarget1.clone();\n\n      renderTarget.width = width;\n      renderTarget.height = height;\n\n      this.reset( renderTarget );\n\n    }\n  }\n\n  return EffectComposer\n}\n","import Delaunay from './delaunay'\nimport Delaunator from 'delaunator';\nimport THREE from './three'\nimport { GPU } from 'gpu.js'\n\nconst gpu = new GPU();\n\n\nexport default function GlRenderer(canvas, maxVertexCnt, isImg, imgPath, videoElement) {\n    this.canvas = canvas;\n    this.maxVertexCnt = maxVertexCnt;\n    this.isImg = isImg;\n    if (!isImg) {\n        this.video = imgPath;\n        this.videoWidth = videoElement.videoWidth;\n        \n        this.videoHeight = videoElement.videoHeight;\n        this.videoElement = videoElement;\n    } else {\n        var callback = videoElement;\n    }\n\n    this.init();\n\n    this.updateImage(imgPath, callback);\n\n    this.hasWireframe = false;\n\n    // window.renderer = this;\n};\n\n\nGlRenderer.prototype.init = function() {\n    this.renderer = new THREE.WebGLRenderer({\n        canvas: this.canvas,\n        antialias: true,\n        preserveDrawingBuffer: true,\n    });\n    this.renderer.setClearColor(0x0);\n\n    this.scene = new THREE.Scene();\n    this.finalScene = new THREE.Scene();\n\n    this.camera = new THREE.OrthographicCamera(-this.canvas.width / 2,\n            this.canvas.width / 2, this.canvas.height / 2,\n            -this.canvas.height / 2, 0, 10);\n\n    this.camera.position.set(0, 0, 8);\n    this.scene.add(this.camera);\n    this.finalScene.add(this.camera);\n\n    var renderPass = new THREE.RenderPass(this.scene, this.camera);\n\n    var edgeShader = new THREE.ShaderPass(THREE.EdgeShader);\n\n    var effectCopy = new THREE.ShaderPass(THREE.CopyShader);\n    effectCopy.renderToScreen = true;\n\n    this.composer = new THREE.EffectComposer(this.renderer);\n    this.composer.addPass(renderPass);\n    this.composer.addPass(edgeShader);\n    this.composer.addPass(effectCopy);\n\n    // material for vertex wireframe\n    this.wireframeMaterial = new THREE.MeshBasicMaterial({\n        wireframe: true,\n        color: 0x000000\n    });\n    this.wireframeMesh = null;\n\n    // material for face color\n    this.faceMaterial = new THREE.MeshBasicMaterial({\n        vertexColors: THREE.FaceColors,\n        color: 0xffffff\n    });\n    this.faceMesh = null;\n\n\n\n    if (!this.isImg) {\n        // video texture, for rendering edge texture\n        this.videoImage = document.createElement('canvas');\n        this.videoImage.width = this.canvas.width;\n        this.videoImage.height = this.canvas.height;\n\n        // video source image canvas, for reading video colors\n        var videoSrcImage = document.createElement('canvas');\n        videoSrcImage.width = this.videoWidth;\n        videoSrcImage.height = this.videoHeight;\n        this.videoSrcCtx = videoSrcImage.getContext('2d');\n\n        this.videoImageContext = this.videoImage.getContext('2d');\n        // background color if no video present\n        this.videoImageContext.fillStyle = '#000000';\n        this.videoImageContext.fillRect(0, 0, this.videoImage.width,\n            this.videoImage.height);\n\n        this.videoTexture = new THREE.Texture(this.videoImage);\n        this.videoTexture.minFilter = THREE.LinearFilter;\n        this.videoTexture.magFilter = THREE.LinearFilter;\n\n        var videoMaterial = new THREE.MeshBasicMaterial({\n            map: this.videoTexture,\n            overdraw: true\n        });\n        var videoGeometry = new THREE.PlaneBufferGeometry(this.videoImage.width,\n            this.videoImage.height);\n        this.videoMesh = new THREE.Mesh(videoGeometry, videoMaterial);\n        this.videoMesh.position.set(0, 0, -1);\n        this.scene.add(this.videoMesh);\n\n        // arrary of selected x and y in last frame,\n        // in video coordinate\n        // {2: [3, 4], 5: [6]} for (x, y) = (2, 3), (2, 4), (5, 6)\n        this.lastSelected = {};\n        this.thisSelected = {};\n    }\n};\n\n\n\n// set maximum vertex cnt\nGlRenderer.prototype.setVertexCnt = function(cnt) {\n    this.maxVertexCnt = cnt;\n};\n\nGlRenderer.prototype.setTriangleRendering = function(enabled) {\n    this.renderTrianglesEnabled = enabled\n}\n\n// returns bool state of if (x, y) is selected to form triangle\nGlRenderer.prototype._isLastSelected = function(x, y) {\n    var ys = this.lastSelected[x];\n    if (ys) {\n        for (var i = ys.length - 1; i >= 0; --i) {\n            if (ys[i] === y) {\n                return true;\n            }\n        }\n    }\n    return false;\n};\n\n// push to thisSelected array, won't check if has already added\nGlRenderer.prototype._setThisSelected = function(x, y) {\n    var ys = this.thisSelected[x];\n    if (ys) {\n        ys.push(y);\n    } else {\n        this.thisSelected[x] = [y];\n    }\n};\n\n\n\n// display and hide wireframe\nGlRenderer.prototype.setWireframe = function(hasWireframe) {\n    if (this.wireframeMesh) {\n        this.wireframeMesh.visible = hasWireframe;\n        if (this.hasWireframe !== hasWireframe) {\n            this.renderer.render(this.finalScene, this.camera);\n            this.hasWireframe = hasWireframe;\n        }\n    }\n};\n\n\n\n// change to a new image\nGlRenderer.prototype.updateImage = function(imgPath, callback) {\n    this.imgPath = imgPath;\n    this._renderSize = null;\n    this.clear();\n    if (this.imgMesh) {\n        this.scene.remove(this.imgMesh);\n        this.imgMesh = null;\n    }\n\n    // render the srcImg to get pixel color later\n    this.preRender(callback);\n};\n\n\n\n// remove objects from the scene\nGlRenderer.prototype.clear = function() {\n    // remove meshes from scene\n    if (this.faceMesh) {\n        this.finalScene.remove(this.faceMesh);\n        this.faceMesh = null;\n    }\n    if (this.wireframeMesh) {\n        this.finalScene.remove(this.wireframeMesh);\n        this.wireframeMesh = null;\n    }\n};\n\n// render again without changing triangle positions\nGlRenderer.prototype.render = function(callback) {\n    this.clear();\n\n    if (!this.isImg) {\n        this.preRender();\n    }\n\n\n    var size = this.getRenderSize();\n\n    // plane for render target\n    var that = this;\n    if (this.isImg) {\n        // image\n        var srcTexture = THREE.ImageUtils.loadTexture(this.imgPath, {}, process);\n        srcTexture.magFilter = THREE.LinearFilter;\n        srcTexture.minFilter = THREE.LinearFilter;\n        this.imgMesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(\n            size.w, size.h), new THREE.MeshBasicMaterial({\n                map: srcTexture\n        }));\n        this.imgMesh.position.z = -1;\n        this.scene.add(this.imgMesh);\n    } else {\n        // video\n        this.videoImageContext.drawImage(this.video, 0, 0);\n        if (this.videoTexture) {\n            this.videoTexture.needsUpdate = true;\n        }\n        process();\n\n        // set thisSelected to lastSelected\n        this.lastSelected = this.thisSelected;\n        this.thisSelected = {};\n    }\n\n    if (callback) {\n        callback();\n    }\n\n    function process() {\n        that.composer.render();\n        // read pixels of edge detection\n        var gl = that.renderer.getContext();\n        let iw, ih\n\n        if (that.isImg) {\n            iw = size.w;\n            ih = size.h;\n            that.pixels = new Uint8Array(iw * ih * 4);\n            that.renderTrianglesEnabled && gl.readPixels(size.ow, size.oh, size.w, size.h,\n                gl.RGBA, gl.UNSIGNED_BYTE, that.pixels);\n        } else {\n            iw = that.videoWidth;\n            ih = that.videoHeight;\n            that.pixels = new Uint8Array(iw * ih * 4);\n            that.renderTrianglesEnabled && gl.readPixels(0, that.canvas.height - ih, iw, ih,\n                gl.RGBA, gl.UNSIGNED_BYTE, that.pixels);\n        }\n\n        that.vertices = [[0, 0], [0, 1], [1, 0], [1, 1]];\n        // append to vertex array\n        var len = iw * ih;\n        var loops = 0;\n        var i = 4;\n        // select those edges that in lastSelected\n        for (var xi in that.lastSelected) {\n            var x = parseInt(xi, 10);\n            if (that.lastSelected[xi] !== undefined) {\n                for (var yi = that.lastSelected[xi].length; yi >= 0; --yi) {\n                    var y = that.lastSelected[xi][yi];\n                    var id = y * iw + x;\n                    var red = that.pixels[id * 4];\n                    if (red > 40 && Math.random() > 0.2) {\n                        that._setThisSelected(xi, y);\n                        that.vertices.push([x / iw, y / ih]);\n                        ++i;\n                    }\n                }\n            }\n        }\n        var edgeCnt = Math.floor(that.maxVertexCnt * 0.95);\n        var maxLoop = that.maxVertexCnt * 100;\n        for (; i < edgeCnt && loops < maxLoop; ++i, ++loops) {\n            const id = Math.floor(Math.random() * len);\n            const x = id % iw;\n            const y = Math.floor(id / iw);\n            const red = that.pixels[id * 4];\n            if (red > 100 || red > Math.random() * 100) {\n                // is a selected edge vertex\n                if (!that.isImg) {\n                    that._setThisSelected(x, y);\n                }\n\n                that.vertices.push([x / iw, y / ih]);\n            } else {\n                --i;\n            }\n        }\n\n        for (; i < that.maxVertexCnt; ++i) {\n            // randomly selected vertices will not push to thisSelected\n            var rx = Math.random();\n            var ry = Math.random();\n            that.vertices.push([rx, ry]);\n            if (!that.isImg) {\n                that._setThisSelected(Math.floor(rx * iw),\n                        Math.floor(ry * ih));\n            }\n        }\n\n        // calculate delaunay triangles\n        if (that.renderTrianglesEnabled) {\n            // that.triangles = Delaunay.triangulate(that.vertices);\n            that.triangles = Delaunator.from(that.vertices).triangles;\n    \n            // render triangle meshes\n            that.renderTriangles(iw, ih);\n        }\n    }\n};\n\n\n\n// render triangle meshes to screen\nGlRenderer.prototype.renderTriangles = function(iw, ih) {\n    this.faceMesh = [];\n    let iwn, ihn\n    const vertices = this.vertices;\n    const triangles = this.triangles;\n    const size = this.getRenderSize();\n    if (this.isImg) {\n        iwn = this.srcImg.width;\n        ihn = this.srcImg.height;\n    } else {\n        iwn = iw;\n        ihn = ih;\n    }\n    // face mesh\n    var geo = new THREE.Geometry();\n    var len = triangles.length;\n    var fid = 0;\n    \n    for(var i = triangles.length - 1; i > 2; i -= 3) {\n        // positions of three vertices\n        var a = [vertices[triangles[i]][0] * size.w + size.dw,\n                vertices[triangles[i]][1] * size.h + size.dh];\n        var b = [vertices[triangles[i - 1]][0] * size.w + size.dw,\n                vertices[triangles[i - 1]][1] * size.h + size.dh];\n        var c = [vertices[triangles[i - 2]][0] * size.w + size.dw,\n                vertices[triangles[i - 2]][1] * size.h + size.dh];\n\n        // fill with color in center of gravity\n        var x = Math.floor((vertices[triangles[i]][0]\n                + vertices[triangles[i - 1]][0]\n                + vertices[triangles[i - 2]][0]) / 3 * iwn);\n        var y = ihn - Math.floor((vertices[triangles[i]][1]\n                + vertices[triangles[i - 1]][1]\n                + vertices[triangles[i - 2]][1]) / 3 * ihn);\n        x = Math.min(iwn, Math.max(0, x - 1));\n        y = Math.min(ihn, Math.max(0, y - 1));\n        var id = (y * iwn + x) * 4;\n        var rgb = 'rgb(' + this.srcPixel[id] + ', ' + this.srcPixel[id + 1]\n                + ', ' + this.srcPixel[id + 2] + ')';\n\n        // draw the triangle\n        geo.vertices.push(new THREE.Vector3(a[0], a[1], 1));\n        geo.vertices.push(new THREE.Vector3(b[0], b[1], 1));\n        geo.vertices.push(new THREE.Vector3(c[0], c[1], 1));\n        geo.faces.push(new THREE.Face3(len - i - 1, len - i, len - i + 1));\n        geo.faces[fid++].color = new THREE.Color(rgb);\n    }\n    this.faceMesh = new THREE.Mesh(geo, this.faceMaterial);\n    this.finalScene.add(this.faceMesh);\n\n    this.wireframeMesh = new THREE.Mesh(geo, this.wireframeMaterial);\n    this.wireframeMesh.position.z = 2;\n    if (!this.hasWireframe) {\n        this.wireframeMesh.visible = false;\n    }\n    this.finalScene.add(this.wireframeMesh);\n\n    this.renderer.render(this.finalScene, this.camera);\n}\n\n\n\nGlRenderer.prototype.resize = function() {\n    // TODO: this function still not works yet\n    var h = this.canvas.height;\n    var w = this.canvas.width;\n\n    this.camera.aspect = w / h;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(w, h);\n    this.composer.setSize(w, h);\n\n    this._renderSize = null; // flag to recalculate\n}\n\n\n\n// render origin image to get pixel color\nGlRenderer.prototype.preRender = function(callback) {\n    if (this.isImg) {\n        // original image\n        this.srcImg = new Image();\n        this.srcImg.src = this.imgPath;\n\n        var that = this;\n        var img = this.srcImg;\n        this.srcImg.onload = function() {\n            // tmp canvas\n            var canvas = document.createElement('canvas');\n            canvas.width = img.width;\n            canvas.height = img.height;\n            var srcCtx = canvas.getContext('2d');\n            srcCtx.drawImage(img, 0, 0, img.width, img.height);\n\n            that.srcPixel = srcCtx.getImageData(0, 0, img.width, img.height).data;\n\n            that.render();\n\n            if (callback) {\n                callback();\n            }\n        };\n    } else {\n        this.videoSrcCtx.drawImage(this.videoElement, 0, 0,\n            this.videoWidth, this.videoHeight);\n        // console.log(this.videoImage.toDataURL());\n        this.srcPixel = this.videoSrcCtx.getImageData(0, 0,\n            this.videoWidth, this.videoHeight).data;\n    }\n}\n\n\n\nGlRenderer.prototype.getRenderSize = function() {\n    if (this._renderSize) {\n        return this._renderSize;\n    }\n\n    const imgWidth = this.isImg ? this.srcImg.width : this.videoWidth;\n    const imgHeight = this.isImg ? this.srcImg.height : this.videoHeight;\n\n    var cw = this.canvas.width;\n    var ch = this.canvas.height;\n\n    var iw = imgWidth;\n    var ih = imgHeight;\n    let w, h, ow, oh\n\n    if (cw / ch > iw / ih) {\n        /* |----------------------|\n         * |    |************|    |\n         * |    |************|    |\n         * |    |************|    |\n         * |    |************|    |\n         * |----------------------|\n         */\n        // clip left and right part of the canvas\n        w = Math.floor(ch / ih * iw);\n        h = ch;\n        ow = Math.floor((cw - w) / 2); // offset\n        oh = 0;\n    } else {\n        /* |----------------------|\n         * |                      |\n         * |----------------------|\n         * |**********************|\n         * |**********************|\n         * |----------------------|\n         * |                      |\n         * |----------------------|\n         */\n        // clip top and bottom part of the canvas\n        w = cw;\n        h = Math.floor(cw / iw * ih);\n        ow = 0;\n        oh = Math.floor((ch - h) / 2);\n    }\n\n    this._renderSize = {\n        w: w,\n        h: h,\n        dw: Math.floor(ow - cw / 2),\n        dh: Math.floor(oh - ch / 2),\n        ow: ow,\n        oh: oh\n    };\n    return this._renderSize;\n}\n","import React from 'react'\nimport './btnrecord.scss'\n\nexport default ({ onClick, showHH }) => (\n  <div className=\"btnrecord\">\n    <input onChange={onClick} type=\"checkbox\" id=\"btn\"/>\n    <label htmlFor=\"btn\"></label>\n    <div className=\"time\">\n      <div className={`${showHH ? 'hh' : ''} h_m`}></div>\n      <div className=\"s_ms\"></div>\n    </div>\n  </div>\n)\n","import React from 'react'\nimport './toggleswitch.scss'\n\nexport default ({ onChange }) => (\n  <div className=\"toggleswitch\">\n    <input className=\"switch\" id=\"switch\" type=\"checkbox\" onChange={onChange} />\n    <label className=\"switch-label\" htmlFor=\"switch\">Select</label>\n  </div> \n)","import React from 'react'\nimport ModalOptions from './ModalOptions'\n\n\nexport default class Options extends React.Component {\n  \n  render() {\n    return (\n      <div />\n    )\n  }\n}\n\n","import download from '../lib/download'\n\nfunction convertDataURIToBinary(dataURI) {\n  var base64 = dataURI.substring(23);\n  var raw = window.atob(base64);\n  var rawLength = raw.length;\n\n  var array = new Uint8Array(new ArrayBuffer(rawLength));\n  for (let i = 0; i < rawLength; i++) {\n      array[i] = raw.charCodeAt(i);\n  }\n  return array;\n};\n\nclass Recorder {\n  constructor(options = {}) {\n    this.isCCapturer = options.ccapturer\n    this.frames = []\n    if (this.isCCapturer) {\n      // Created and initialized on start\n      return\n    }\n    this.worker = new Worker(`${process.env.PUBLIC_URL}/ffmpeg-worker-mp4.js`);\n    this.worker.onmessage = function (e) {\n        var msg = e.data;\n\n        switch (msg.type) {\n            case \"ready\":\n                console.log('mp4 worker ready');\n                break;\n            case \"stdout\":\n                console.log(msg.data);\n                break;\n            case \"stderr\":\n                console.log(msg.data);\n                break;\n\n            case \"done\":\n                console.log(\"done\")\n                var blob = new Blob([msg.data.MEMFS[0].data], {\n                    type: \"video/mp4\"\n                });\n                if (navigator.share) {\n                  navigator.share({\n                    title: 'Polinized',\n                      text: 'Video Mp4',\n                      url: blob,\n                  })\n                }\n                download(blob, \"polinized.mp4\", 'video/mp4')\n                break;\n\n            case \"exit\":\n                console.log(\"Process exited with code \" + msg.data);\n                break;\n            default:\n                console.log(\"unkown msg type\" + msg.data);\n            break;\n        }\n    };\n  }\n\n  addFrame(canvas) {\n    if (this.isCCapturer) {\n      this.worker.capture(canvas)\n      return\n    }\n    const urlData = canvas.toDataURL('image/jpeg');\n    const binaryFrame = convertDataURIToBinary(urlData)\n    this.frames.push({\n      name: `${this.frames.length}.jpeg`,\n      data: binaryFrame\n    })\n  }\n\n  start({ fps }) {\n    this.fps = fps\n    if (this.isCCapturer) {\n      // eslint-disable-next-line\n      this.worker = new CCapture({\n        framerate: fps * 2 || 15,\n        format: 'webm'\n      });\n      this.worker.start()\n    }\n  }\n  save() {\n    if (this.isCCapturer) {\n      this.worker.stop()\n      this.worker.save()\n      return\n    }\n    this.worker.postMessage(\n      {\n          type: \"run\",\n          TOTAL_MEMORY: 268435456,\n          MEMFS: this.frames,\n          arguments: [\n            \"-y\",\n            \"-r\", `${this.fps}`,\n            // \"-r\", \"30\", // Set framerate\n            \"-pattern_type\", \"glob\",\n            \"-i\", \"*.jpeg\",\n            \"-vsync\", \"1\",\n            \"-c:v\", \"libx264\",\n            \"-x264opts\", \"no-scenecut\",\n            \"-sc_threshold\", \"10\",\n            \"-maxrate\", \"2M\",\n            \"-vf\", \"scale=480:640\",\n            \"-pix_fmt\", \"yuv420p\",\n            \"-vb\", \"1M\", // video bitrate to 1M\n            \"-crf\", \"5\", // Low quality x264\n            \"-preset\", \"ultrafast\",\n            \"-tune\", \"film\",\n            \"-an\",\n            \"out.mp4\"\n          ]\n      }\n    );\n  }\n}\n\n\nexport default Recorder","//download.js v3.0, by dandavis; 2008-2014. [CCBY2] see http://danml.com/download.html for tests/usage\n// v1 landed a FF+Chrome compat way of downloading strings to local un-named files, upgraded to use a hidden frame and optional mime\n// v2 added named files via a[download], msSaveBlob, IE (10+) support, and window.URL support for larger+faster saves than dataURLs\n// v3 added dataURL and Blob Input, bind-toggle arity, and legacy dataURL fallback was improved with force-download mime and base64 support\n\n// data can be a string, Blob, File, or dataURL\n\n\t\t \n\t\t\t\t\t\t \n\t\t\t\t\t\t \nexport default function download(data, strFileName, strMimeType) {\n\t\n\tvar self = window, // this script is only for browsers anyway...\n\t\tu = \"application/octet-stream\", // this default mime also triggers iframe downloads\n\t\tm = strMimeType || u, \n\t\tx = data,\n\t\tD = document,\n\t\ta = D.createElement(\"a\"),\n\t\tz = function(a){return String(a);},\n\t\t\n\t\t\n\t\tB = self.Blob || self.MozBlob || self.WebKitBlob || z,\n\t\tBB = self.MSBlobBuilder || self.WebKitBlobBuilder || self.BlobBuilder,\n\t\tfn = strFileName || \"download\",\n\t\tblob, \n\t\tb,\n\t\tua,\n\t\tfr;\n\n\t//if(typeof B.bind === 'function' ){ B=B.bind(self); }\n\t\n\tif(String(this)===\"true\"){ //reverse arguments, allowing download.bind(true, \"text/xml\", \"export.xml\") to act as a callback\n\t\tx=[x, m];\n\t\tm=x[0];\n\t\tx=x[1]; \n\t}\n\t\n\t\n\t\n\t//go ahead and download dataURLs right away\n\tif(String(x).match(/^data\\:[\\w+\\-]+\\/[\\w+\\-]+[,;]/)){\n\t\treturn navigator.msSaveBlob ?  // IE10 can't do a[download], only Blobs:\n\t\t\tnavigator.msSaveBlob(d2b(x), fn) : \n\t\t\tsaver(x) ; // everyone else can save dataURLs un-processed\n\t}//end if dataURL passed?\n\t\n\ttry{\n\t\n\t\tblob = x instanceof B ? \n\t\t\tx : \n\t\t\tnew B([x], {type: m}) ;\n\t}catch(y){\n\t\tif(BB){\n\t\t\tb = new BB();\n\t\t\tb.append([x]);\n\t\t\tblob = b.getBlob(m); // the blob\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t\n\tfunction d2b(u) {\n\t\tvar p= u.split(/[:;,]/),\n\t\tt= p[1],\n\t\tdec= p[2] == \"base64\" ? atob : decodeURIComponent,\n\t\tbin= dec(p.pop()),\n\t\tmx= bin.length,\n\t\ti= 0,\n\t\tuia= new Uint8Array(mx);\n\n\t\tfor(i;i<mx;++i) uia[i]= bin.charCodeAt(i);\n\n\t\treturn new B([uia], {type: t});\n\t }\n\t  \n\tfunction saver(url, winMode){\n\t\t\n\t\t\n\t\tif ('download' in a) { //html5 A[download] \t\t\t\n\t\t\ta.href = url;\n\t\t\ta.setAttribute(\"download\", fn);\n\t\t\ta.innerHTML = \"downloading...\";\n\t\t\tD.body.appendChild(a);\n\t\t\tsetTimeout(function() {\n\t\t\t\ta.click();\n\t\t\t\tD.body.removeChild(a);\n\t\t\t\tif(winMode===true){setTimeout(function(){ self.URL.revokeObjectURL(a.href);}, 250 );}\n\t\t\t}, 66);\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\t//do iframe dataURL download (old ch+FF):\n\t\tvar f = D.createElement(\"iframe\");\n\t\tD.body.appendChild(f);\n\t\tif(!winMode){ // force a mime that will download:\n\t\t\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, u);\n\t\t}\n\t\t \n\t\n\t\tf.src = url;\n\t\tsetTimeout(function(){ D.body.removeChild(f); }, 333);\n\t\t\n\t}//end saver \n\t\t\n\n\tif (navigator.msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\n\t\treturn navigator.msSaveBlob(blob, fn);\n\t} \t\n\t\n\tif(self.URL){ // simple fast and modern way using Blob and URL:\n\t\tsaver(self.URL.createObjectURL(blob), true);\n\t}else{\n\t\t// handle non-Blob()+non-URL browsers:\n\t\tif(typeof blob === \"string\" || blob.constructor===z ){\n\t\t\ttry{\n\t\t\t\treturn saver( \"data:\" +  m   + \";base64,\"  +  self.btoa(blob)  ); \n\t\t\t}catch(y){\n\t\t\t\treturn saver( \"data:\" +  m   + \",\" + encodeURIComponent(blob)  ); \n\t\t\t}\n\t\t}\n\t\t\n\t\t// Blob but not URL:\n\t\tfr=new FileReader();\n\t\tfr.onload=function(e){\n\t\t\tsaver(this.result); \n\t\t};\n\t\tfr.readAsDataURL(blob);\n\t}\t\n\treturn true;\n} /* end download() */\n","import React from 'react'\nimport GlRenderer from '../lib/GlRenderer'\nimport BtnRecord from '../BtnRecord'\nimport ToggleSwitch from '../ToggleSwitch'\nimport MenuOptions from '../MenuOptions'\nimport Recorder from './Recorder'\nimport './video.css'\n\nexport default class Video extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      isReady: false,\n      isRecording: false,\n      isCapturerReady: false,\n    }\n    this.devices = []\n    this.fpsmeter = React.createRef()\n    this.handlePlayState = this.handlePlayState.bind(this)\n    this.renderFrame =  this.renderFrame.bind(this)\n    this.handleRecord = this.handleRecord.bind(this)\n    this.prepare = this.prepare.bind(this)\n    this.logFPS = this.logFPS.bind(this)\n    this.framesRendered = 0\n    this.framesLow = 0\n    this.canvas = React.createRef();\n    this.renderer = null\n  }\n\n  componentWillMount() {\n    this.video = document.createElement('video');\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia ||\n        navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\n    if (!navigator.getUserMedia) {\n      alert(\"navigator.getUserMedia not supported\")\n      return\n    }\n\n    this.prepare()\n  }\n\n  componentDidMount() {\n    this.canvas.current.width = window.innerWidth;\n    this.canvas.current.height = window.innerHeight;\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.isPlaying !== this.state.isPlaying) {\n      this.handlePlayState()\n    }\n  }\n\n  logFPS() {\n    this.fpsmeter.current.innerHTML = this.framesRendered\n    this.framesLow = (this.framesLow === 0 || this.framesLow > this.framesRendered) ? this.framesRendered : this.framesLow\n    this.framesRendered = 0;\n  }\n\n  handlePlayState() {\n    if (this.state.isPlaying) {\n      this.video.play();\n\n      setInterval(this.logFPS, 1000)\n\n      this.renderer = new GlRenderer(this.canvas.current, 4000, false, this.video, this.video);\n      this.renderFrame()\n    } else {\n      clearInterval(this.logFPS)\n      this.video.src = \"\"\n    }\n  }\n\n  handleRecord() {\n    if (this.state.isRecording) {\n      this.setState({isRecording: false})\n      this.capturer.save({ fps: this.framesLow })\n    } else {\n      this.setState({isRecording: true})\n      this.capturer.start({ fps: this.framesLow })\n    }\n  }\n\n  async prepare() {\n    navigator.mediaDevices.enumerateDevices().then(devices => {\n      devices.forEach(device => {\n        if (device.kind === 'videoinput') {\n          this.devices.push(device)\n        }\n      })\n\n      navigator.getUserMedia({\n        video: {\n          deviceId: { exact: (this.devices[1] || this.devices[0]).deviceId }\n        }\n      }, (stream) => {\n          this.stream = stream\n          this.video.srcObject = stream;\n          this.video.onloadedmetadata = () => {\n            this.setState({\n              isReady: true,\n              isPlaying: true\n            })\n          }\n          this.video.load();\n      }, function (err) {\n          alert('Camera is not accesible.');\n      });\n      \n    }).then(() => {\n      this.capturer = new Recorder({ ccapturer: true })\n      this.setState({ isCapturerReady: true })\n    })\n      .catch(err => {\n        alert(err)\n      });\n  }\n\n  render() {\n    const { isReady, isCapturerReady, isRecording, isPlaying } = this.state\n    return (\n      <div className=\"video-content\">\n        <canvas id=\"canvas\" ref={this.canvas} />\n        <div className=\"video-overlay\">\n          <div className=\"fps-counter\" ref={this.fpsmeter} />\n          <MenuOptions />\n          <BtnRecord onClick={this.handleRecord} disabled={!isReady || !isCapturerReady}></BtnRecord>\n          <ToggleSwitch onChange={({ target }) => {\n            this.renderer.setTriangleRendering(target.checked)\n          }} />\n        </div>\n      </div>\n    )\n  }\n\n  renderFrame() {\n    this.framesRendered++\n    this.renderer.render();\n    if (this.state.isRecording) {\n      this.capturer.addFrame( this.canvas.current ) //this.canvas.current );\n    }\n    if (this.state.isPlaying) {\n      requestAnimationFrame(this.renderFrame);\n    }\n  }\n}\n","import React, { Component } from 'react';\nimport './app.scss';\nimport Video from './Video'\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <Video publicUrl={this.props.publicUrl}/>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}